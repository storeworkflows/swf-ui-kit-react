{"version":3,"sources":["../../src/Popover/Popover.js"],"names":["Popover","props","targetClicked","bind","state","opened","targetDimensions","contentDimensions","targetRef","React","createRef","contentRef","children","content","positionTarget","target","current","onclick","manageOpened","onClick","currentState","setState","undefined","value","updateDimensions","newTargetDimensions","getBoundingClientRect","newContentDimensions","setStylesToContent","positions","hideTail","roundBorder","contentElement","console","log","stylesInfo","window","innerWidth","styles","style","addTop","parseInt","top","replace","addLeft","left","transform","x","y","visibility","hasArrow","Object","entries","arrowStyle","key","setProperty","dimensions","dimensionsToCompare","height","width","currentTargetDimensions","isSameDimensions","visible","hidden","changeContentVisibility","renderContent","renderTarget","Component","Content","Target","defaultProps","propTypes","bool","oneOfType","func","shape","any","arrayOf","string"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport propTypes from \"prop-types\";\r\n\r\nimport styles from \"./styles.scss\";\r\nimport findByType, {createSubComponent} from \"../utils/findByType\";\r\nimport {getAllPossibleVariants, getPopoverStyle} from \"./utils\";\r\n\r\nclass Popover extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.targetClicked = this.targetClicked.bind(this)\r\n\r\n        this.state = {\r\n            opened: false,\r\n            targetDimensions: null,\r\n            contentDimensions: null\r\n        }\r\n\r\n        this.targetRef = React.createRef();\r\n        this.contentRef = React.createRef();\r\n    }\r\n\r\n    renderContent() {\r\n        const {children} = this.props;\r\n        const content = findByType(children, \"Content\");\r\n\r\n        if (!content)\r\n            return null;\r\n\r\n        return <div className=\"popover-content\"\r\n                    ref={this.contentRef}>\r\n                {content} </div>;\r\n\r\n    }\r\n\r\n    renderTarget() {\r\n        const {children, positionTarget} = this.props;\r\n        const target = findByType(children, \"Target\");\r\n\r\n        if(positionTarget){\r\n            if(this.targetRef.current === null)\r\n                this.targetRef = positionTarget;\r\n\r\n            this.targetRef.current.onclick = this.targetClicked;\r\n            return null;\r\n        }\r\n\r\n        if (!target)\r\n            return null;\r\n\r\n        return <div className={\"popover-target\"}\r\n                    ref={this.targetRef}\r\n                    onClick={ this.targetClicked }>\r\n                        {target}\r\n                </div>\r\n\r\n    }\r\n\r\n    targetClicked (){\r\n        const {manageOpened, onClick} = this.props;\r\n        let currentState = this.state.opened;\r\n        if(!manageOpened) {\r\n            currentState = !currentState\r\n            this.setState({\r\n                opened: currentState\r\n            });\r\n        }\r\n\r\n        if(onClick!==undefined && onClick!==null)\r\n            onClick({value: currentState})\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setState({\r\n            opened: this.props.opened\r\n        })\r\n        this.updateDimensions();\r\n\r\n    }\r\n\r\n    updateDimensions(){\r\n        let newTargetDimensions = this.targetRef.current.getBoundingClientRect()\r\n        let newContentDimensions = this.contentRef.current.getBoundingClientRect()\r\n        this.setState({\r\n            contentDimensions: newContentDimensions,\r\n            targetDimensions: newTargetDimensions\r\n        })\r\n        this.setStylesToContent(newTargetDimensions);\r\n    }\r\n\r\n    setStylesToContent() {\r\n\r\n        const {positions, hideTail, roundBorder} = this.props;\r\n        let targetDimensions = this.targetRef.current.getBoundingClientRect()\r\n        let contentElement = this.contentRef.current;\r\n        let contentDimensions = contentElement.getBoundingClientRect();\r\n\r\n        console.log(\"target\", targetDimensions);\r\n         console.log(\"content\", contentDimensions);\r\n\r\n        let stylesInfo = getPopoverStyle(positions, targetDimensions, contentDimensions, window.innerWidth, hideTail, roundBorder);\r\n        let styles = stylesInfo.style;\r\n        let addTop = parseInt(styles.top.replace(\"px\", ''));\r\n        let addLeft = parseInt(styles.left.replace(\"px\", ''));\r\n\r\n        contentElement.style.transform = styles.transform;\r\n        contentElement.style.left = targetDimensions.x - contentDimensions.x + addLeft + \"px\";\r\n        contentElement.style.top = targetDimensions.y - contentDimensions.y + addTop  + \"px\";\r\n        contentElement.style.visibility = \"visible\";\r\n\r\n        // console.log(\"transform \", styles);\r\n        // console.log(contentElement.getBoundingClientRect())\r\n\r\n        if (!hideTail && stylesInfo.hasArrow) {\r\n            for (const [key, value] of Object.entries(stylesInfo.arrowStyle))\r\n                contentElement.style.setProperty(key, value);\r\n        }\r\n    }\r\n\r\n    changeContentVisibility(visibility){\r\n        let contentElement = this.contentRef.current;\r\n        if(contentElement)\r\n            contentElement.style.visibility = visibility;\r\n    }\r\n\r\n    isSameDimensions(dimensions, dimensionsToCompare){\r\n        return dimensions.x === dimensionsToCompare.x\r\n            && dimensions.y === dimensionsToCompare.y\r\n            && dimensions.height === dimensionsToCompare.height\r\n            && dimensions.width === dimensionsToCompare.width;\r\n    }\r\n\r\n    isDimensionsChanged(){\r\n        let currentTargetDimensions = this.targetRef.current.getBoundingClientRect();\r\n        return !this.isSameDimensions(this.state.targetDimensions, currentTargetDimensions);\r\n    }\r\n\r\n    componentDidUpdate(){\r\n        const visible = \"visible\";\r\n        const hidden = \"hidden\";\r\n\r\n        if(this.props.manageOpened && this.props.opened!== this.state.opened)\r\n            this.setState({opened: this.props.opened})\r\n\r\n        if(this.state.opened) {\r\n            // if(this.isDimensionsChanged())\r\n            //     this.updateDimensions();\r\n            this.changeContentVisibility(visible);\r\n        }\r\n        else\r\n            this.changeContentVisibility(hidden);\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <style type=\"text/css\">{styles}</style>\r\n                {this.renderContent()}\r\n                {this.renderTarget()}\r\n            </>\r\n        );\r\n    }\r\n};\r\n\r\nPopover.Content = createSubComponent(\"Content\");\r\nPopover.Target = createSubComponent(\"Target\");\r\n\r\nPopover.defaultProps = {\r\n    hideTail: false,\r\n    manageOpened: false,\r\n    opened: false,\r\n    positions: getAllPossibleVariants(),\r\n    roundBorder: true,\r\n}\r\n\r\nPopover.propTypes = {\r\n    hideTail: propTypes.bool,\r\n    manageOpened: propTypes.bool,\r\n    opened: propTypes.bool,\r\n    positionTarget: propTypes.oneOfType([\r\n        propTypes.func,\r\n        propTypes.shape({ current: propTypes.any })\r\n    ]),\r\n    positions: propTypes.arrayOf(propTypes.shape({\r\n        target: propTypes.string,\r\n        content: propTypes.string,\r\n    })),\r\n    onClick: propTypes.func,\r\n    roundBorder: propTypes.bool\r\n}\r\n\r\nexport default Popover"],"file":"Popover.js"}