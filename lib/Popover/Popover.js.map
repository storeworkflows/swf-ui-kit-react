{"version":3,"sources":["../../src/Popover/Popover.js"],"names":["Popover","props","targetClicked","bind","updateOpenedState","state","opened","targetRef","React","createRef","contentRef","children","roundBorder","content","positionTarget","target","current","resetStyles","setStylesToContent","onclick","manageOpened","onClick","currentState","undefined","value","positions","hideTail","contentElement","style","maxHeight","maxWidth","targetDimensions","getBoundingClientRect","contentDimensions","windowParam","startY","startX","endY","window","innerHeight","endX","innerWidth","stylesInfo","styles","transform","left","top","visibility","hasArrow","Object","entries","arrowStyle","key","setProperty","openedValue","setState","renderContent","renderTarget","Component","Content","Target","defaultProps","propTypes","bool","oneOfType","func","shape","any","arrayOf","string"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport propTypes from \"prop-types\";\r\n\r\nimport styles from \"./styles.scss\";\r\nimport findByType, {createSubComponent} from \"../utils/findByType\";\r\nimport {getAllPossibleVariants, getPopoverStyle} from \"./utils\";\r\nimport classnames from \"classnames\";\r\n\r\nclass Popover extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.targetClicked = this.targetClicked.bind(this);\r\n        this.updateOpenedState = this.updateOpenedState.bind(this);\r\n\r\n        this.state = {\r\n            opened: false\r\n        }\r\n\r\n        this.targetRef = React.createRef();\r\n        this.contentRef = React.createRef();\r\n    }\r\n\r\n    renderContent() {\r\n        const {children, roundBorder} = this.props;\r\n        const content = findByType(children, \"Content\");\r\n\r\n        if (!content)\r\n            return null;\r\n\r\n        return <div className={classnames({\r\n                    \"popover-content\": true,\r\n                    \"noRoundBorder\": !roundBorder\r\n                    })}\r\n                    ref={this.contentRef}>\r\n            <div className={\"popover-content-keeper\"}>{content}</div>\r\n            </div>;\r\n\r\n    }\r\n\r\n    renderTarget() {\r\n        const {children, positionTarget} = this.props;\r\n        const target = findByType(children, \"Target\");\r\n\r\n        if(positionTarget){\r\n            if(this.targetRef.current === null || this.targetRef!==positionTarget)\r\n            {\r\n                this.targetRef = positionTarget;\r\n                if(this.contentRef && this.contentRef.current){\r\n                    this.resetStyles();\r\n                    if(this.state.opened)\r\n                        this.setStylesToContent()\r\n                }\r\n            }\r\n\r\n            this.targetRef.current.onclick = this.targetClicked;\r\n            return null;\r\n        }\r\n\r\n        if (!target)\r\n            return null;\r\n\r\n        return <div className={\"popover-target\"}\r\n                    ref={this.targetRef}\r\n                    onClick={ this.targetClicked }>\r\n                        {target}\r\n                </div>\r\n\r\n    }\r\n\r\n    targetClicked (){\r\n        const {manageOpened, onClick} = this.props;\r\n        let currentState = this.state.opened;\r\n        if(!manageOpened) {\r\n            currentState = !currentState\r\n            this.updateOpenedState(currentState)\r\n        }\r\n\r\n        if(onClick!==undefined && onClick!==null)\r\n            onClick({value: currentState})\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateOpenedState(this.props.opened)\r\n    }\r\n\r\n\r\n    setStylesToContent() {\r\n        if(this.contentRef && this.contentRef.current) {\r\n            const {positions, hideTail, roundBorder} = this.props;\r\n            let contentElement = this.contentRef.current;\r\n            contentElement.children[0].style.maxHeight = 'none';\r\n            contentElement.children[0].style.maxWidth = 'none';\r\n\r\n            let targetDimensions = this.targetRef.current.getBoundingClientRect()\r\n            let contentDimensions = contentElement.getBoundingClientRect();\r\n\r\n            let windowParam = {\r\n                startY: 0,\r\n                startX: 0,\r\n                endY: window.innerHeight,\r\n                endX: window.innerWidth\r\n            }\r\n\r\n            let stylesInfo = getPopoverStyle(positions, targetDimensions, contentDimensions, windowParam, hideTail, roundBorder);\r\n            let styles = stylesInfo.style;\r\n\r\n            contentElement.style.transform = styles.transform;\r\n            contentElement.style.left = styles.left;\r\n            contentElement.style.top = styles.top;\r\n            contentElement.style.visibility = \"visible\";\r\n            if(styles.maxHeight)\r\n                contentElement.children[0].style.maxHeight = styles.maxHeight;\r\n            if(styles.maxWidth)\r\n                contentElement.children[0].style.maxWidth = styles.maxWidth;\r\n\r\n            if (!hideTail && stylesInfo.hasArrow) {\r\n                for (const [key, value] of Object.entries(stylesInfo.arrowStyle))\r\n                    contentElement.style.setProperty(key, value);\r\n            }\r\n        }\r\n    }\r\n\r\n    resetStyles(){\r\n        if(this.contentRef && this.contentRef.current)\r\n        {\r\n            let contentElement = this.contentRef.current;\r\n            contentElement.style.visibility = \"hidden\";\r\n            contentElement.style.transform = `translate3d(${0}px, ${0}px, 0)`\r\n            contentElement.style.left =  0;\r\n            contentElement.style.top = 0;\r\n        }\r\n    }\r\n\r\n\r\n    componentDidUpdate(){\r\n        let openedValue = this.props.opened;\r\n        if(this.props.manageOpened && this.props.opened!== this.state.opened)\r\n            this.updateOpenedState(openedValue)\r\n    }\r\n\r\n    updateOpenedState(value){\r\n        if(value)\r\n            this.setStylesToContent();\r\n        else\r\n            this.resetStyles();\r\n\r\n        this.setState({opened: value})\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <style type=\"text/css\">{styles}</style>\r\n                {this.renderContent()}\r\n                {this.renderTarget()}\r\n            </>\r\n        );\r\n    }\r\n};\r\n\r\nPopover.Content = createSubComponent(\"Content\");\r\nPopover.Target = createSubComponent(\"Target\");\r\n\r\nPopover.defaultProps = {\r\n    hideTail: false,\r\n    manageOpened: false,\r\n    opened: false,\r\n    positions: getAllPossibleVariants(),\r\n    roundBorder: true,\r\n}\r\n\r\nPopover.propTypes = {\r\n    hideTail: propTypes.bool,\r\n    manageOpened: propTypes.bool,\r\n    opened: propTypes.bool,\r\n    positionTarget: propTypes.oneOfType([\r\n        propTypes.func,\r\n        propTypes.shape({ current: propTypes.any })\r\n    ]),\r\n    positions: propTypes.arrayOf(propTypes.shape({\r\n        target: propTypes.string,\r\n        content: propTypes.string,\r\n    })),\r\n    onClick: propTypes.func,\r\n    roundBorder: propTypes.bool\r\n}\r\n\r\nexport default Popover"],"file":"Popover.js"}