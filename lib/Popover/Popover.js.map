{"version":3,"sources":["../../src/Popover/Popover.js"],"names":["Popover","props","targetClicked","bind","setStylesToContent","resetStyles","state","opened","targetRef","React","createRef","contentRef","children","content","positionTarget","target","current","onclick","manageOpened","onClick","currentState","setState","undefined","value","positions","hideTail","roundBorder","contentElement","targetDimensions","getBoundingClientRect","contentDimensions","stylesInfo","window","innerWidth","styles","style","transform","left","top","visibility","hasArrow","Object","entries","arrowStyle","key","setProperty","renderContent","renderTarget","Component","Content","Target","defaultProps","propTypes","bool","oneOfType","func","shape","any","arrayOf","string"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport propTypes from \"prop-types\";\n\nimport styles from \"./styles.scss\";\nimport findByType, {createSubComponent} from \"../utils/findByType\";\nimport {getAllPossibleVariants, getPopoverStyle} from \"./utils\";\n\nclass Popover extends React.Component {\n    constructor(props) {\n        super(props);\n        this.targetClicked = this.targetClicked.bind(this);\n        this.setStylesToContent = this.setStylesToContent.bind(this);\n        this.resetStyles = this.resetStyles(this);\n\n        this.state = {\n            opened: false\n        }\n\n        this.targetRef = React.createRef();\n        this.contentRef = React.createRef();\n    }\n\n    renderContent() {\n        const {children} = this.props;\n        const content = findByType(children, \"Content\");\n\n        if (!content)\n            return null;\n\n        return <div className=\"popover-content\"\n                    ref={this.contentRef}>\n                {content} </div>;\n\n    }\n\n    renderTarget() {\n        const {children, positionTarget} = this.props;\n        const target = findByType(children, \"Target\");\n\n        if(positionTarget){\n            if(this.targetRef.current === null)\n                this.targetRef = positionTarget;\n\n            this.targetRef.current.onclick = this.targetClicked;\n            return null;\n        }\n\n        if (!target)\n            return null;\n\n        return <div className={\"popover-target\"}\n                    ref={this.targetRef}\n                    onClick={ this.targetClicked }>\n                        {target}\n                </div>\n\n    }\n\n    targetClicked (){\n        const {manageOpened, onClick} = this.props;\n        let currentState = this.state.opened;\n        if(!manageOpened) {\n            currentState = !currentState\n            this.setState({\n                opened: currentState\n            });\n        }\n\n        if(onClick!==undefined && onClick!==null)\n            onClick({value: currentState})\n    }\n\n    componentDidMount() {\n        this.setState({\n            opened: this.props.opened\n        })\n    }\n\n\n    setStylesToContent() {\n\n        const {positions, hideTail, roundBorder} = this.props;\n        let contentElement = this.contentRef.current;\n\n        let targetDimensions = this.targetRef.current.getBoundingClientRect()\n        let contentDimensions = contentElement.getBoundingClientRect();\n\n        let stylesInfo = getPopoverStyle(positions, targetDimensions, contentDimensions, window.innerWidth, hideTail, roundBorder);\n        let styles = stylesInfo.style;\n\n        contentElement.style.transform = styles.transform;\n        contentElement.style.left =  styles.left;\n        contentElement.style.top = styles.top;\n        contentElement.style.visibility = \"visible\";\n\n        if (!hideTail && stylesInfo.hasArrow) {\n            for (const [key, value] of Object.entries(stylesInfo.arrowStyle))\n                contentElement.style.setProperty(key, value);\n        }\n    }\n\n    resetStyles(){\n        let contentElement = this.contentRef.current;\n\n        if(contentElement)\n        {\n            contentElement.style.visibility = \"hidden\";\n            contentElement.style.transform = `translate3d(${0}px, ${0}px, 0)`\n            contentElement.style.left =  0;\n            contentElement.style.top = 0;\n        }\n    }\n\n\n    componentDidUpdate(){\n\n        if(this.props.manageOpened && this.props.opened!== this.state.opened)\n            this.setState({opened: this.props.opened})\n\n        if(this.state.opened)\n            this.setStylesToContent();\n        else\n            this.resetStyles();\n    }\n\n\n    render() {\n        return (\n            <>\n                <style type=\"text/css\">{styles}</style>\n                {this.renderContent()}\n                {this.renderTarget()}\n            </>\n        );\n    }\n};\n\nPopover.Content = createSubComponent(\"Content\");\nPopover.Target = createSubComponent(\"Target\");\n\nPopover.defaultProps = {\n    hideTail: false,\n    manageOpened: false,\n    opened: false,\n    positions: getAllPossibleVariants(),\n    roundBorder: true,\n}\n\nPopover.propTypes = {\n    hideTail: propTypes.bool,\n    manageOpened: propTypes.bool,\n    opened: propTypes.bool,\n    positionTarget: propTypes.oneOfType([\n        propTypes.func,\n        propTypes.shape({ current: propTypes.any })\n    ]),\n    positions: propTypes.arrayOf(propTypes.shape({\n        target: propTypes.string,\n        content: propTypes.string,\n    })),\n    onClick: propTypes.func,\n    roundBorder: propTypes.bool\n}\n\nexport default Popover"],"file":"Popover.js"}